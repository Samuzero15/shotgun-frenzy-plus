ACTOR sandbag_built 30554
{
	radius 2
	height 2
	states
	{
		Spawn:
			BULD A 1 A_SpawnItemEx ("Sandbags2", 32, -8, 64)
			BULD A 1 A_SpawnItemEx ("Sandbags3", 48, -4, 64)
			BULD A 1 A_SpawnItemEx ("Sandbags1", 0, 0, 64)
			BULD A 1 A_SpawnItemEx ("Sandbags2", -16, 0, 64)
			BULD A 1 A_SpawnItemEx ("Sandbags3", -32, -8, 64)
			BULD A 1 A_SpawnItemEx ("Sandbags1", -48, -4, 64)
			stop
	}
}

ACTOR Sandbag_Build : Inventory
{
	radius 64
	height 32
	
	inventory.pickupmessage "You have activated the build protocol!"
	
	//+COUNTITEM
	inventory.amount 0
	
	renderstyle add
	
	states
	{
		Spawn:
			TNT1 A 0
			TNT1 A 0 A_GiveInventory("build_check")
			TNT1 A 0 A_SpawnItem("Sandbag_Building")
		Spawn2:
			BULD A 1 A_SpawnItem("BuildableMarker")
			loop
	}
}

ACTOR Sandbag_Building : BuildBase
{
	renderstyle add
	
	states
	{
		Spawn2:
			BULD A 1
			BULD A 1 A_SpawnItemEx ("Sandbags2", -8, 32, 64)
			BULD A 1 A_SpawnItemEx ("Sandbags3", -4, 48, 64)
			BULD A 1 A_SpawnItemEx ("Sandbags1", 0, 0, 64)
			BULD A 1 A_SpawnItemEx ("Sandbags2", 0, -16, 64)
			BULD A 1 A_SpawnItemEx ("Sandbags3", -8, -32, 64)
			BULD A 1 A_SpawnItemEx ("Sandbags1", -4, -48, 64)
			stop
	}
}

ACTOR Sandbags1
{
	Health 300
	Speed 0
	Radius 32
	Height 50
	MONSTER
	-ISMONSTER //Makes it spawnable everywhere
	+FASTER +FASTMELEE +FRIENDLY +NEVERRESPAWN +SOLID +SPAWNCEILING +NOBLOOD
	
	// protect from marine damage
	damagefactor "MarineFire", 0.0
	damagefactor "MarineFire2", 0.0
	DamageFactor "MarineFire3", 0.0
        DamageFactor "BFGSplash", 0.0
        DamageFactor "BFGSpray", 0.0
	
	scale 0.8
	Obituary "Got killed by a sandbag... lol, what a sissy..."
	states
	{
		Spawn:
			SAND AA 10 A_Look
			goto Spawn
		See:
			SAND AAAAAAAA 2 A_Chase
			goto See
		Melee:
			SAND AA 8 A_FaceTarget
			SAND A 132 A_CustomMeleeAttack (1, "", "", "", 0) 
			goto See
		Pain:
			SAND A 2
			SAND A 2 A_Pain
			goto See
		Death:
			SAND A 2
                        POSS A 0 A_SpawnDebris("splatSandbag1")
                        POSS A 0 A_SpawnDebris("splatSandbag2")
                        POSS A 0 A_SpawnDebris("splatSandbag3")
                        POSS A 0 A_SpawnDebris("splatSandbag1")
                        POSS A 0 A_SpawnDebris("splatSandbag2")
                        stop
	}
}

ACTOR Sandbags2
{
	Health 300
	Speed 0
	Radius 32
	Height 50
	MONSTER
	-ISMONSTER //Makes it spawnable everywhere
	+FASTER +FASTMELEE +FRIENDLY +NEVERRESPAWN +SOLID +SPAWNCEILING +NOBLOOD
	scale 0.8
	Obituary "Got killed by a sandbag... lol, what a sissy..."
	
	// protect from marine damage
	damagefactor "MarineFire", 0.0
	damagefactor "MarineFire2", 0.0
	DamageFactor "MarineFire3", 0.0
        DamageFactor "BFGSplash", 0.0
        DamageFactor "BFGSpray", 0.0
	
	states
	{
		Spawn:
			SAND BB 10 A_Look
			goto Spawn
		See:
			SAND BBBBBBBB 2 A_Chase
			goto See
		Melee:
			SAND BB 8 A_FaceTarget
			SAND B 132 A_CustomMeleeAttack (1, "", "", "", 0) 
			goto See
		Pain:
			SAND B 2
			SAND B 2 A_Pain
			goto See
		Death:
			SAND B 2
                        POSS A 0 A_SpawnDebris("splatSandbag1")
                        POSS A 0 A_SpawnDebris("splatSandbag2")
                        POSS A 0 A_SpawnDebris("splatSandbag3")
                        POSS A 0 A_SpawnDebris("splatSandbag1")
                        POSS A 0 A_SpawnDebris("splatSandbag2")
                        stop
	}
}

ACTOR Sandbags3
{
	Health 300
	Speed 0
	Radius 32
	Height 50
	MONSTER
	-ISMONSTER //Makes it spawnable everywhere
	+FASTER +FASTMELEE +FRIENDLY +NEVERRESPAWN +SOLID +SPAWNCEILING +NOBLOOD
	scale 0.8
	Obituary "Got killed by a sandbag... lol, what a sissy..."
	
	// protect from marine damage
	damagefactor "MarineFire", 0.0
	damagefactor "MarineFire2", 0.0
	DamageFactor "MarineFire3", 0.0
        DamageFactor "BFGSplash", 0.0
        DamageFactor "BFGSpray", 0.0
	
	states
	{
		Spawn:
			SAND CC 10 A_Look
			goto Spawn
		See:
			SAND CCCCCCCC 2 A_Chase
			goto See
		Melee:
			SAND CC 8 A_FaceTarget
			SAND C 132 A_CustomMeleeAttack (1, "", "", "", 0) 
			goto See
		Pain:
			SAND C 2
			SAND C 2 A_Pain
			goto See
		Death:
			SAND C 2
                        POSS A 0 A_SpawnDebris("splatSandbag1")
                        POSS A 0 A_SpawnDebris("splatSandbag2")
                        POSS A 0 A_SpawnDebris("splatSandbag3")
                        POSS A 0 A_SpawnDebris("splatSandbag1")
                        POSS A 0 A_SpawnDebris("splatSandbag2")
                        stop
	}
}
